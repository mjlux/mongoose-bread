"use strict";function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return(b=_toPropertyKey(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _toPropertyKey(a){var b=_toPrimitive(a,"string");return"symbol"==typeof b?b:b+""}function _toPrimitive(a,b){if("object"!=typeof a||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=typeof d)return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}var toBreadErrorFactory=require("./toBreadErrorFactory");function browseFactory(a){function b(a,b){var c=b.query,d=b.paginateOptions,e=d.limit,f=d.projection,g=[c];return e&&g.push({$limit:e}),f&&g.push({$project:_objectSpread({},f)}),a.aggregate(g).then(function(a){return{docs:a,pagination:{totalDocs:a.length,offset:0,limit:e,totalPages:1,page:1,pagingCounter:1,hasPrevPage:!1,hasNextPage:!1,prevPage:null,nextPage:null}}})}var c=a.customLabels,d=c.docs,e=c.acknowledged,f=c.readCount,g=function(a){return _objectSpread(_objectSpread({},a),{},{[e]:!0,[f]:a[d].length})},h=toBreadErrorFactory({[d]:[],[e]:!1,[f]:0});return function(c){var d=this,e=_objectSpread(_objectSpread({},a),c),f=e.query,i=e.paginateOptions,j=e.enableAtlasSearch,k=e.atlasSearchIndex,l=i.lean,m=i.leanWithId,n=i.leanWithout_id,o=i.customLabels,p=i.customCount,q=l&&m&&n?function(a){var b="docs";return o&&o.docs&&"string"==typeof o.docs&&(b=o.docs),a[b].forEach(function(a){a._id&&delete a._id}),a}:function(a){return a};return j&&k?b(this,e).then(q).then(g).catch(h):(p&&this[p]&&"function"==typeof this[p]&&(i.useCustomCountFn=function(){return d[p]()}),this.paginate(f,i).then(q).then(g).catch(h))}}module.exports=browseFactory;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ0b0JyZWFkRXJyb3JGYWN0b3J5IiwicmVxdWlyZSIsImJyb3dzZUZhY3RvcnkiLCJwbHVnaW5PcHRpb25zIiwicnVuQXRsYXNTZWFyY2giLCJtb2RlbCIsIm9wdGlvbnMiLCJxdWVyeSIsInBhZ2luYXRlT3B0aW9ucyIsImxpbWl0IiwicHJvamVjdGlvbiIsInBpcGVsaW5lIiwicHVzaCIsIiRsaW1pdCIsIiRwcm9qZWN0IiwiX29iamVjdFNwcmVhZCIsImFnZ3JlZ2F0ZSIsInRoZW4iLCJkb2NzIiwicGFnaW5hdGlvbiIsInRvdGFsRG9jcyIsImxlbmd0aCIsIm9mZnNldCIsInRvdGFsUGFnZXMiLCJwYWdlIiwicGFnaW5nQ291bnRlciIsImhhc1ByZXZQYWdlIiwiaGFzTmV4dFBhZ2UiLCJwcmV2UGFnZSIsIm5leHRQYWdlIiwiYyIsImN1c3RvbUxhYmVscyIsImFja25vd2xlZGdlZCIsInJlYWRDb3VudCIsInRvQnJlYWRSZXN1bHQiLCJyZXN1bHQiLCJ0b0JyZWFkRXJyb3IiLCJkIiwiX29wdGlvbnMiLCJlbmFibGVBdGxhc1NlYXJjaCIsImF0bGFzU2VhcmNoSW5kZXgiLCJsZWFuIiwibGVhbldpdGhJZCIsImxlYW5XaXRob3V0X2lkIiwiY3VzdG9tQ291bnQiLCJyZW1vdmVfaWQiLCJkb2NzS2V5IiwiZm9yRWFjaCIsImRvYyIsIl9pZCIsImNhdGNoIiwidXNlQ3VzdG9tQ291bnRGbiIsInBhZ2luYXRlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9mYWN0b3JpZXMvYnJvd3NlRmFjdG9yeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdpbmF0ZU1vZGVsLCBQaXBlbGluZVN0YWdlIH0gZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgeyBNb25nb29zZUJyZWFkQnJvd3NlT3B0aW9ucywgTW9uZ29vc2VCcmVhZE9wdGlvbnMgfSBmcm9tIFwiLi4vLi4vdHlwZXNcIjtcblxuY29uc3QgdG9CcmVhZEVycm9yRmFjdG9yeSA9IHJlcXVpcmUoXCIuL3RvQnJlYWRFcnJvckZhY3RvcnlcIik7XG5cbmZ1bmN0aW9uIGJyb3dzZUZhY3RvcnkocGx1Z2luT3B0aW9uczogTW9uZ29vc2VCcmVhZE9wdGlvbnMpIHtcblx0Y29uc3QgeyBkb2NzLCBhY2tub3dsZWRnZWQsIHJlYWRDb3VudCB9ID0gcGx1Z2luT3B0aW9ucy5jdXN0b21MYWJlbHM7XG5cdGNvbnN0IHRvQnJlYWRSZXN1bHQgPSAocmVzdWx0OiBhbnkpID0+ICh7XG5cdFx0Li4ucmVzdWx0LFxuXHRcdFthY2tub3dsZWRnZWRdOiB0cnVlLFxuXHRcdFtyZWFkQ291bnRdOiByZXN1bHRbZG9jc10ubGVuZ3RoLFxuXHR9KTtcblx0Y29uc3QgdG9CcmVhZEVycm9yID0gdG9CcmVhZEVycm9yRmFjdG9yeSh7XG5cdFx0W2RvY3NdOiBbXSxcblx0XHRbYWNrbm93bGVkZ2VkXTogZmFsc2UsXG5cdFx0W3JlYWRDb3VudF06IDAsXG5cdH0pO1xuXG5cdGZ1bmN0aW9uIHJ1bkF0bGFzU2VhcmNoKG1vZGVsOiBQYWdpbmF0ZU1vZGVsPGFueT4sIG9wdGlvbnM6IE1vbmdvb3NlQnJlYWRPcHRpb25zICYgTW9uZ29vc2VCcmVhZEJyb3dzZU9wdGlvbnMpIHtcblx0XHRjb25zdCB7IHF1ZXJ5LCBwYWdpbmF0ZU9wdGlvbnMgfSA9IG9wdGlvbnM7XG5cdFx0Y29uc3QgeyBsaW1pdCwgcHJvamVjdGlvbiB9ID0gcGFnaW5hdGVPcHRpb25zO1xuXG5cdFx0Y29uc3QgcGlwZWxpbmU6IFBpcGVsaW5lU3RhZ2VbXSA9IFtxdWVyeSBhcyBQaXBlbGluZVN0YWdlXTtcblx0XHRpZiAobGltaXQpIHBpcGVsaW5lLnB1c2goeyAkbGltaXQ6IGxpbWl0IH0pO1xuXHRcdGlmIChwcm9qZWN0aW9uKSBwaXBlbGluZS5wdXNoKHsgJHByb2plY3Q6IHsgLi4ucHJvamVjdGlvbiB9IH0pO1xuXG5cdFx0cmV0dXJuIG1vZGVsLmFnZ3JlZ2F0ZShwaXBlbGluZSkudGhlbigoZG9jczogYW55W10pID0+IHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGRvY3MsXG5cdFx0XHRcdHBhZ2luYXRpb246IHtcblx0XHRcdFx0XHR0b3RhbERvY3M6IGRvY3MubGVuZ3RoLFxuXHRcdFx0XHRcdG9mZnNldDogMCxcblx0XHRcdFx0XHRsaW1pdDogbGltaXQsXG5cdFx0XHRcdFx0dG90YWxQYWdlczogMSxcblx0XHRcdFx0XHRwYWdlOiAxLFxuXHRcdFx0XHRcdHBhZ2luZ0NvdW50ZXI6IDEsXG5cdFx0XHRcdFx0aGFzUHJldlBhZ2U6IGZhbHNlLFxuXHRcdFx0XHRcdGhhc05leHRQYWdlOiBmYWxzZSxcblx0XHRcdFx0XHRwcmV2UGFnZTogbnVsbCxcblx0XHRcdFx0XHRuZXh0UGFnZTogbnVsbCxcblx0XHRcdFx0fSxcblx0XHRcdH07XG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gZnVuY3Rpb24gYnJvd3NlKFxuXHRcdHRoaXM6IFBhZ2luYXRlTW9kZWw8YW55PiAmIHsgY291bnREb2N1bWVudHNEZWxldGVkPzogKCkgPT4gUHJvbWlzZTxudW1iZXI+IH0sXG5cdFx0b3B0aW9uczogTW9uZ29vc2VCcmVhZEJyb3dzZU9wdGlvbnNcblx0KSB7XG5cdFx0Y29uc3QgX29wdGlvbnM6IE1vbmdvb3NlQnJlYWRPcHRpb25zICYgTW9uZ29vc2VCcmVhZEJyb3dzZU9wdGlvbnMgPSB7IC4uLnBsdWdpbk9wdGlvbnMsIC4uLm9wdGlvbnMgfTtcblxuXHRcdGNvbnN0IHsgcXVlcnksIHBhZ2luYXRlT3B0aW9ucywgZW5hYmxlQXRsYXNTZWFyY2gsIGF0bGFzU2VhcmNoSW5kZXggfSA9IF9vcHRpb25zO1xuXHRcdGNvbnN0IHsgbGVhbiwgbGVhbldpdGhJZCwgbGVhbldpdGhvdXRfaWQsIGN1c3RvbUxhYmVscywgY3VzdG9tQ291bnQgfSA9IHBhZ2luYXRlT3B0aW9ucztcblxuXHRcdGNvbnN0IHJlbW92ZV9pZCA9ICEobGVhbiAmJiBsZWFuV2l0aElkICYmIGxlYW5XaXRob3V0X2lkKVxuXHRcdFx0PyAocmVzdWx0OiBhbnkpID0+IHJlc3VsdFxuXHRcdFx0OiAocmVzdWx0OiBhbnkpID0+IHtcblx0XHRcdFx0XHRsZXQgZG9jc0tleSA9IFwiZG9jc1wiO1xuXHRcdFx0XHRcdGlmIChjdXN0b21MYWJlbHMgJiYgY3VzdG9tTGFiZWxzLmRvY3MgJiYgdHlwZW9mIGN1c3RvbUxhYmVscy5kb2NzID09IFwic3RyaW5nXCIpIHtcblx0XHRcdFx0XHRcdGRvY3NLZXkgPSBjdXN0b21MYWJlbHMuZG9jcztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmVzdWx0W2RvY3NLZXldLmZvckVhY2goKGRvYzogYW55KSA9PiB7XG5cdFx0XHRcdFx0XHRpZiAoZG9jLl9pZCkgZGVsZXRlIGRvYy5faWQ7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdCAgfTtcblxuXHRcdGlmIChlbmFibGVBdGxhc1NlYXJjaCAmJiBhdGxhc1NlYXJjaEluZGV4KSB7XG5cdFx0XHRyZXR1cm4gcnVuQXRsYXNTZWFyY2godGhpcywgX29wdGlvbnMpLnRoZW4ocmVtb3ZlX2lkKS50aGVuKHRvQnJlYWRSZXN1bHQpLmNhdGNoKHRvQnJlYWRFcnJvcik7XG5cdFx0fVxuXG5cdFx0aWYgKGN1c3RvbUNvdW50ICYmIHRoaXNbY3VzdG9tQ291bnRdICYmIHR5cGVvZiB0aGlzW2N1c3RvbUNvdW50XSA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRwYWdpbmF0ZU9wdGlvbnMudXNlQ3VzdG9tQ291bnRGbiA9ICgpID0+IHRoaXNbY3VzdG9tQ291bnRdKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMucGFnaW5hdGUocXVlcnksIHBhZ2luYXRlT3B0aW9ucykudGhlbihyZW1vdmVfaWQpLnRoZW4odG9CcmVhZFJlc3VsdCkuY2F0Y2godG9CcmVhZEVycm9yKTtcblx0fTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBicm93c2VGYWN0b3J5O1xuIl0sIm1hcHBpbmdzIjoiZ25DQUdBLEdBQU0sQ0FBQUEsbUJBQW1CLENBQUdDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUU1RCxRQUFTLENBQUFDLGFBQWFBLENBQUNDLENBQW1DLENBQUUsQ0FhM0QsUUFBUyxDQUFBQyxDQUFjQSxDQUFDQyxDQUF5QixDQUFFQyxDQUEwRCxDQUFFLElBQ3RHLENBQUFDLENBQUssQ0FBc0JELENBQU8sQ0FBbENDLEtBQUssQ0FBRUMsQ0FBZSxDQUFLRixDQUFPLENBQTNCRSxlQUFlLENBQ3RCQyxDQUFLLENBQWlCRCxDQUFlLENBQXJDQyxLQUFLLENBQUVDLENBQVUsQ0FBS0YsQ0FBZSxDQUE5QkUsVUFBVSxDQUVuQkMsQ0FBeUIsQ0FBRyxDQUFDSixDQUFLLENBQWtCLENBSTFELE1BSEksQ0FBQUUsQ0FBSyxFQUFFRSxDQUFRLENBQUNDLElBQUksQ0FBQyxDQUFFQyxNQUFNLENBQUVKLENBQU0sQ0FBQyxDQUFDLENBQ3ZDQyxDQUFVLEVBQUVDLENBQVEsQ0FBQ0MsSUFBSSxDQUFDLENBQUVFLFFBQVEsQ0FBQUMsYUFBQSxJQUFPTCxDQUFVLENBQUcsQ0FBQyxDQUFDLENBRXZETCxDQUFLLENBQUNXLFNBQVMsQ0FBQ0wsQ0FBUSxDQUFDLENBQUNNLElBQUksQ0FBQyxTQUFDQyxDQUFXLENBQUssQ0FDdEQsTUFBTyxDQUNOQSxJQUFJLENBQUpBLENBQUksQ0FDSkMsVUFBVSxDQUFFLENBQ1hDLFNBQVMsQ0FBRUYsQ0FBSSxDQUFDRyxNQUFNLENBQ3RCQyxNQUFNLENBQUUsQ0FBQyxDQUNUYixLQUFLLENBQUVBLENBQUssQ0FDWmMsVUFBVSxDQUFFLENBQUMsQ0FDYkMsSUFBSSxDQUFFLENBQUMsQ0FDUEMsYUFBYSxDQUFFLENBQUMsQ0FDaEJDLFdBQVcsR0FBTyxDQUNsQkMsV0FBVyxHQUFPLENBQ2xCQyxRQUFRLENBQUUsSUFBSSxDQUNkQyxRQUFRLENBQUUsSUFDWCxDQUNELENBQ0QsQ0FBQyxDQUNGLENBQUMsSUFBQUMsQ0FBQSxDQXJDeUMzQixDQUFhLENBQUM0QixZQUFZLENBQTVEYixDQUFJLENBQUFZLENBQUEsQ0FBSlosSUFBSSxDQUFFYyxDQUFZLENBQUFGLENBQUEsQ0FBWkUsWUFBWSxDQUFFQyxDQUFTLENBQUFILENBQUEsQ0FBVEcsU0FBUyxDQUMvQkMsQ0FBYSxDQUFHLFFBQUFBLENBQUNDLENBQVcsU0FBQXBCLGFBQUEsQ0FBQUEsYUFBQSxJQUM5Qm9CLENBQU0sTUFDVCxDQUFDSCxDQUFZLElBQU8sQ0FDcEIsQ0FBQ0MsQ0FBUyxFQUFHRSxDQUFNLENBQUNqQixDQUFJLENBQUMsQ0FBQ0csTUFBTSxHQUMvQixDQUNJZSxDQUFZLENBQUdwQyxtQkFBbUIsQ0FBQyxDQUN4QyxDQUFDa0IsQ0FBSSxFQUFHLEVBQUUsQ0FDVixDQUFDYyxDQUFZLElBQVEsQ0FDckIsQ0FBQ0MsQ0FBUyxFQUFHLENBQ2QsQ0FBQyxDQUFDLENBNkJGLE1BQU8sVUFFTjNCLENBQW1DLENBQ2xDLEtBQUErQixDQUFBLE1BQ0tDLENBQTJELENBQUF2QixhQUFBLENBQUFBLGFBQUEsSUFBUVosQ0FBYSxFQUFLRyxDQUFPLENBQUUsQ0FFNUZDLENBQUssQ0FBMkQrQixDQUFRLENBQXhFL0IsS0FBSyxDQUFFQyxDQUFlLENBQTBDOEIsQ0FBUSxDQUFqRTlCLGVBQWUsQ0FBRStCLENBQWlCLENBQXVCRCxDQUFRLENBQWhEQyxpQkFBaUIsQ0FBRUMsQ0FBZ0IsQ0FBS0YsQ0FBUSxDQUE3QkUsZ0JBQWdCLENBQzNEQyxDQUFJLENBQTREakMsQ0FBZSxDQUEvRWlDLElBQUksQ0FBRUMsQ0FBVSxDQUFnRGxDLENBQWUsQ0FBekVrQyxVQUFVLENBQUVDLENBQWMsQ0FBZ0NuQyxDQUFlLENBQTdEbUMsY0FBYyxDQUFFWixDQUFZLENBQWtCdkIsQ0FBZSxDQUE3Q3VCLFlBQVksQ0FBRWEsQ0FBVyxDQUFLcEMsQ0FBZSxDQUEvQm9DLFdBQVcsQ0FFN0RDLENBQVMsQ0FBS0osQ0FBSSxFQUFJQyxDQUFVLEVBQUlDLENBQWMsQ0FFckQsU0FBQ1IsQ0FBVyxDQUFLLENBQ2pCLEdBQUksQ0FBQVcsQ0FBTyxDQUFHLE1BQU0sQ0FPcEIsTUFOSSxDQUFBZixDQUFZLEVBQUlBLENBQVksQ0FBQ2IsSUFBSSxFQUFnQyxRQUFRLEVBQXBDLE1BQU8sQ0FBQWEsQ0FBWSxDQUFDYixJQUFnQixHQUM1RTRCLENBQU8sQ0FBR2YsQ0FBWSxDQUFDYixJQUFJLEVBRTVCaUIsQ0FBTSxDQUFDVyxDQUFPLENBQUMsQ0FBQ0MsT0FBTyxDQUFDLFNBQUNDLENBQVEsQ0FBSyxDQUNqQ0EsQ0FBRyxDQUFDQyxHQUFHLEVBQUUsTUFBTyxDQUFBRCxDQUFHLENBQUNDLEdBQ3pCLENBQUMsQ0FBQyxDQUNLZCxDQUNQLENBQUMsQ0FWRCxTQUFDQSxDQUFXLFFBQUssQ0FBQUEsQ0FBTSxDQVV0QixPQUVBLENBQUFJLENBQWlCLEVBQUlDLENBQWdCLENBQ2pDcEMsQ0FBYyxDQUFDLElBQUksQ0FBRWtDLENBQVEsQ0FBQyxDQUFDckIsSUFBSSxDQUFDNEIsQ0FBUyxDQUFDLENBQUM1QixJQUFJLENBQUNpQixDQUFhLENBQUMsQ0FBQ2dCLEtBQUssQ0FBQ2QsQ0FBWSxDQUFDLEVBRzFGUSxDQUFXLEVBQUksSUFBSSxDQUFDQSxDQUFXLENBQUMsRUFBaUMsVUFBVSxFQUF2QyxNQUFPLEtBQUksQ0FBQ0EsQ0FBVyxDQUFnQixHQUU5RXBDLENBQWUsQ0FBQzJDLGdCQUFnQixDQUFHLGlCQUFNLENBQUFkLENBQUksQ0FBQ08sQ0FBVyxDQUFDLENBQUMsQ0FBQyxHQUd0RCxJQUFJLENBQUNRLFFBQVEsQ0FBQzdDLENBQUssQ0FBRUMsQ0FBZSxDQUFDLENBQUNTLElBQUksQ0FBQzRCLENBQVMsQ0FBQyxDQUFDNUIsSUFBSSxDQUFDaUIsQ0FBYSxDQUFDLENBQUNnQixLQUFLLENBQUNkLENBQVksQ0FBQyxDQUNyRyxDQUNELENBRUFpQixNQUFNLENBQUNDLE9BQU8sQ0FBR3BELGFBQWEiLCJpZ25vcmVMaXN0IjpbXX0=
"use strict";function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return(b=_toPropertyKey(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _toPropertyKey(a){var b=_toPrimitive(a,"string");return"symbol"==typeof b?b:b+""}function _toPrimitive(a,b){if("object"!=typeof a||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=typeof d)return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}var toBreadErrorFactory=require("./toBreadErrorFactory");function browseFactory(a){function b(a,b){var c=b.query,d=b.paginateOptions,e=d.limit,f=d.projection,g=[c];return e&&g.push({$limit:e}),f&&g.push({$project:_objectSpread({},f)}),a.aggregate(g).then(function(a){return{docs:a,pagination:{totalDocs:a.length,offset:0,limit:e,totalPages:1,page:1,pagingCounter:1,hasPrevPage:!1,hasNextPage:!1,prevPage:null,nextPage:null}}})}var c=a.customLabels,d=c.docs,e=c.acknowledged,f=c.readCount,g=function(a){return _objectSpread(_objectSpread({},a),{},{[e]:!0,[f]:a[d].length})},h=toBreadErrorFactory({[d]:[],[e]:!1,[f]:0});return function(c){var d=this,e=_objectSpread(_objectSpread({},a),c),f=e.query,i=e.paginateOptions,j=e.enableAtlasSearch,k=e.atlasSearchIndex,l=i.lean,m=i.leanWithId,n=i.leanWithout_id,o=i.customLabels,p=i.customCount,q=l&&m&&n?function(a){var b="docs";return o&&o.docs&&"string"==typeof o.docs&&(b=o.docs),a[b].forEach(function(a){a._id&&delete a._id}),a}:function(a){return a};return j&&k?b(this,e).then(q).then(g).catch(h):(p&&this[p]&&"function"==typeof this[p]&&(i.useCustomCountFn=function(){return d[p]()}),this.paginate(f,i).then(q).then(g).catch(h))}}module.exports=browseFactory;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ0b0JyZWFkRXJyb3JGYWN0b3J5IiwicmVxdWlyZSIsImJyb3dzZUZhY3RvcnkiLCJwbHVnaW5PcHRpb25zIiwicnVuQXRsYXNTZWFyY2giLCJtb2RlbCIsIm9wdGlvbnMiLCJxdWVyeSIsInBhZ2luYXRlT3B0aW9ucyIsImxpbWl0IiwicHJvamVjdGlvbiIsInBpcGVsaW5lIiwicHVzaCIsIiRsaW1pdCIsIiRwcm9qZWN0IiwiX29iamVjdFNwcmVhZCIsImFnZ3JlZ2F0ZSIsInRoZW4iLCJkb2NzIiwicGFnaW5hdGlvbiIsInRvdGFsRG9jcyIsImxlbmd0aCIsIm9mZnNldCIsInRvdGFsUGFnZXMiLCJwYWdlIiwicGFnaW5nQ291bnRlciIsImhhc1ByZXZQYWdlIiwiaGFzTmV4dFBhZ2UiLCJwcmV2UGFnZSIsIm5leHRQYWdlIiwiYyIsImN1c3RvbUxhYmVscyIsImFja25vd2xlZGdlZCIsInJlYWRDb3VudCIsInRvQnJlYWRSZXN1bHQiLCJyZXN1bHQiLCJ0b0JyZWFkRXJyb3IiLCJkIiwiX29wdGlvbnMiLCJlbmFibGVBdGxhc1NlYXJjaCIsImF0bGFzU2VhcmNoSW5kZXgiLCJsZWFuIiwibGVhbldpdGhJZCIsImxlYW5XaXRob3V0X2lkIiwiY3VzdG9tQ291bnQiLCJyZW1vdmVfaWQiLCJkb2NzS2V5IiwiZm9yRWFjaCIsImRvYyIsIl9pZCIsImNhdGNoIiwidXNlQ3VzdG9tQ291bnRGbiIsInBhZ2luYXRlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9mYWN0b3JpZXMvYnJvd3NlRmFjdG9yeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdpbmF0ZU1vZGVsLCBQaXBlbGluZVN0YWdlIH0gZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgeyBNb25nb29zZUJyZWFkQnJvd3NlT3B0aW9ucywgTW9uZ29vc2VCcmVhZE9wdGlvbnMgfSBmcm9tIFwiLi4vLi4vdHlwZXNcIjtcblxuY29uc3QgdG9CcmVhZEVycm9yRmFjdG9yeSA9IHJlcXVpcmUoXCIuL3RvQnJlYWRFcnJvckZhY3RvcnlcIik7XG5cbmZ1bmN0aW9uIGJyb3dzZUZhY3RvcnkocGx1Z2luT3B0aW9uczogTW9uZ29vc2VCcmVhZE9wdGlvbnMpIHtcblx0Y29uc3QgeyBkb2NzLCBhY2tub3dsZWRnZWQsIHJlYWRDb3VudCB9ID0gcGx1Z2luT3B0aW9ucy5jdXN0b21MYWJlbHM7XG5cdGNvbnN0IHRvQnJlYWRSZXN1bHQgPSAocmVzdWx0OiBhbnkpID0+ICh7XG5cdFx0Li4ucmVzdWx0LFxuXHRcdFthY2tub3dsZWRnZWRdOiB0cnVlLFxuXHRcdFtyZWFkQ291bnRdOiByZXN1bHRbZG9jc10ubGVuZ3RoLFxuXHR9KTtcblx0Y29uc3QgdG9CcmVhZEVycm9yID0gdG9CcmVhZEVycm9yRmFjdG9yeSh7XG5cdFx0W2RvY3NdOiBbXSxcblx0XHRbYWNrbm93bGVkZ2VkXTogZmFsc2UsXG5cdFx0W3JlYWRDb3VudF06IDAsXG5cdH0pO1xuXG5cdGZ1bmN0aW9uIHJ1bkF0bGFzU2VhcmNoKG1vZGVsOiBQYWdpbmF0ZU1vZGVsPGFueT4sIG9wdGlvbnM6IE1vbmdvb3NlQnJlYWRPcHRpb25zICYgTW9uZ29vc2VCcmVhZEJyb3dzZU9wdGlvbnMpIHtcblx0XHRjb25zdCB7IHF1ZXJ5LCBwYWdpbmF0ZU9wdGlvbnMgfSA9IG9wdGlvbnM7XG5cdFx0Y29uc3QgeyBsaW1pdCwgcHJvamVjdGlvbiB9ID0gcGFnaW5hdGVPcHRpb25zO1xuXG5cdFx0Y29uc3QgcGlwZWxpbmU6IFBpcGVsaW5lU3RhZ2VbXSA9IFtxdWVyeSBhcyBQaXBlbGluZVN0YWdlXTtcblxuICAgIGlmKGxpbWl0KXtcbiAgICAgIHBpcGVsaW5lLnB1c2goeyAkbGltaXQ6IGxpbWl0IH0pXG4gICAgfVxuXG5cdFx0aWYgKHByb2plY3Rpb24pIHtcblx0XHRcdHBpcGVsaW5lLnB1c2goeyAkcHJvamVjdDogeyAuLi5wcm9qZWN0aW9uIH0gfSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG1vZGVsLmFnZ3JlZ2F0ZShwaXBlbGluZSkudGhlbigoZG9jczogYW55W10pID0+IHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGRvY3MsXG5cdFx0XHRcdHBhZ2luYXRpb246IHtcblx0XHRcdFx0XHR0b3RhbERvY3M6IGRvY3MubGVuZ3RoLFxuXHRcdFx0XHRcdG9mZnNldDogMCxcblx0XHRcdFx0XHRsaW1pdDogbGltaXQsXG5cdFx0XHRcdFx0dG90YWxQYWdlczogMSxcblx0XHRcdFx0XHRwYWdlOiAxLFxuXHRcdFx0XHRcdHBhZ2luZ0NvdW50ZXI6IDEsXG5cdFx0XHRcdFx0aGFzUHJldlBhZ2U6IGZhbHNlLFxuXHRcdFx0XHRcdGhhc05leHRQYWdlOiBmYWxzZSxcblx0XHRcdFx0XHRwcmV2UGFnZTogbnVsbCxcblx0XHRcdFx0XHRuZXh0UGFnZTogbnVsbCxcblx0XHRcdFx0fSxcblx0XHRcdH07XG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gZnVuY3Rpb24gYnJvd3NlKHRoaXM6IFBhZ2luYXRlTW9kZWw8YW55PiAmIHtjb3VudERvY3VtZW50c0RlbGV0ZWQ/OiAoKSA9PiBQcm9taXNlPG51bWJlcj59LCBvcHRpb25zOiBNb25nb29zZUJyZWFkQnJvd3NlT3B0aW9ucykge1xuXHRcdGNvbnN0IF9vcHRpb25zOiBNb25nb29zZUJyZWFkT3B0aW9ucyAmIE1vbmdvb3NlQnJlYWRCcm93c2VPcHRpb25zID0geyAuLi5wbHVnaW5PcHRpb25zLCAuLi5vcHRpb25zIH07XG5cblx0XHRjb25zdCB7IHF1ZXJ5LCBwYWdpbmF0ZU9wdGlvbnMsIGVuYWJsZUF0bGFzU2VhcmNoLCBhdGxhc1NlYXJjaEluZGV4IH0gPSBfb3B0aW9ucztcblx0XHRjb25zdCB7IGxlYW4sIGxlYW5XaXRoSWQsIGxlYW5XaXRob3V0X2lkLCBjdXN0b21MYWJlbHMsIGN1c3RvbUNvdW50IH0gPSBwYWdpbmF0ZU9wdGlvbnM7XG5cblx0XHRjb25zdCByZW1vdmVfaWQgPSAhKGxlYW4gJiYgbGVhbldpdGhJZCAmJiBsZWFuV2l0aG91dF9pZClcblx0XHRcdD8gKHJlc3VsdDogYW55KSA9PiByZXN1bHRcblx0XHRcdDogKHJlc3VsdDogYW55KSA9PiB7XG5cdFx0XHRcdFx0bGV0IGRvY3NLZXkgPSBcImRvY3NcIjtcblx0XHRcdFx0XHRpZiAoY3VzdG9tTGFiZWxzICYmIGN1c3RvbUxhYmVscy5kb2NzICYmIHR5cGVvZiBjdXN0b21MYWJlbHMuZG9jcyA9PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRcdFx0XHRkb2NzS2V5ID0gY3VzdG9tTGFiZWxzLmRvY3M7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJlc3VsdFtkb2NzS2V5XS5mb3JFYWNoKChkb2M6IGFueSkgPT4ge1xuXHRcdFx0XHRcdFx0aWYgKGRvYy5faWQpIGRlbGV0ZSBkb2MuX2lkO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHQgIH07XG5cblx0XHRpZiAoZW5hYmxlQXRsYXNTZWFyY2ggJiYgYXRsYXNTZWFyY2hJbmRleCkge1xuXHRcdFx0cmV0dXJuIHJ1bkF0bGFzU2VhcmNoKHRoaXMsIF9vcHRpb25zKS50aGVuKHJlbW92ZV9pZCkudGhlbih0b0JyZWFkUmVzdWx0KS5jYXRjaCh0b0JyZWFkRXJyb3IpO1xuXHRcdH1cblxuICAgIFxuXHRcdGlmIChjdXN0b21Db3VudCAmJiB0aGlzW2N1c3RvbUNvdW50XSAmJiB0eXBlb2YgdGhpc1tjdXN0b21Db3VudF0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuXHRcdFx0cGFnaW5hdGVPcHRpb25zLnVzZUN1c3RvbUNvdW50Rm4gPSAoKSA9PiB0aGlzW2N1c3RvbUNvdW50XSgpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLnBhZ2luYXRlKHF1ZXJ5LCBwYWdpbmF0ZU9wdGlvbnMpLnRoZW4ocmVtb3ZlX2lkKS50aGVuKHRvQnJlYWRSZXN1bHQpLmNhdGNoKHRvQnJlYWRFcnJvcik7XG5cdH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYnJvd3NlRmFjdG9y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